2014 5 7
=====

虽然题目写的是2014年5月7日，但是记的是昨天发生过的事。

昨天，我终于下定决心开始写js部分。
本着工欲善其事，必先利其器的原则（其实是恐惧拖延症又复发了，所以找了个借口），
我开始完善原来的Vim的JS编辑功能。

嗯，之前就已经给Vim安装了语法高亮的插件，在高亮方面已经没有了缺陷。

那么接下来是要提供一个lint工具。特别是像我这种容易产生typo的人，一个语法检查的工具自然是必不可少的。

著名的Vim插件`syntastic`几乎提供了每种Vim支持的编程语言的语法检查功能。
事实上，`syntastic`只是提供了一个接口，把外部的语法检查工具与Vim内部的缓冲区文本连接在一起了。
不过`syntastic`不能对JS进行语法检查。

在没有任何第三方插件的帮助下，`syntastic`一般是通过调用编译器/解释器的自带语法检查选项来检查语法问题的。
不过，虽然我安装了Node，但是貌似Node没有检查输入的JS文件的语法问题的选项。
这就导致了，如果不引入第三方的插件，`syntastic`是无法检查JS中的语法问题的。

所以我开始找JS的语法检查器。

在网上淘了一下，大概有三个可以入我的候选名单：
1. eslint
2. gslint
3. jshint

首先试用第一个：

eslint
-----

嗯，这个东东看起来好强大，不过有一个问题，就是它的代码洁癖太厉害了，一上来就报了个`use strict`的错误。

什么意思呢？在JS里面，如果我们设置了"use strict"的声明，浏览器就会依照strict mode的标准解析我们的代码。
而eslint默认按照strict mode来评判JS代码，而且它还会要求你提供一个`use strict`的声明。

有没有搞错！我没有声明用`use strict`就是指在宽松模式下嘛！
如果使用了`strict mode`，即使像jQuery这种久经考验的类库也会导致浏览器报错。
不过这也许是jQuery为了兼容各种浏览器所作出的妥协。
当然在Node里就没有这种问题了，因为在Node里所有的包都需要经过`strict mode`的考验。

那么就必须设置eslint忽略掉`strict mode`。
这个是可以设置的。
在经过一番折腾之后，我终于明了eslint的配置方法，就是在`syntastic`的配置中指定eslint的配置路径。
eslint的配置文件是JSON文件，在里面的rules元素中设置`'strict' : 0` 就好了。

但是eslint还是不肯放开我的JS代码。

现在可以看到一个严重的问题。就是eslint会把`window`,`localStrage`等浏览器环境里的对象当作`undef variable`。。。
呃，不过这也可以配置的，可以设置eslint的目标运行环境为brosewer，这样它就会放过浏览器定义的全局对象了，除了——

除了`console`。这怎么能行呢？`console`可是前端调试神器。
翻看了官方文档，他们居然把`no-console`当作一个rule。
给出的理由是不应该使用`console`把程序运行的细节暴露给用户。
嗯，这可不是个好理由啊。我可以在调试时使用`console`，然后在调试后删掉。你犯不着产生一大堆错误提示恶心我吧？
或者，我也可以选择不删，使用debug mode包装每一个调试函数，在启动debug的时候调用`console`，其余状态下什么都不干。
这也不会向用户暴露程序执行的细节。

当然也许存在取消`no-console`这个规则的设置。但是这帮“代码洁癖爱好者”，我还是适应不了，果断换！

下一个：gslint

gslint
-----

gslint是google前端团队的出品。但是这并不一定代表什么……
尤其是，当我看到他们的项目主页是2012年时更新的，而且该项目的最后一次commit是去年秋天。

虽然如此，不过能用就行……

等到我看到install guide的时候，我的信心又少了一些。
比起其他的lint工具，gslint居然不是用js写的，而是用python写的。
而且它的安装方式还是用easy\_install。
而如今，easy\_install的唯一的作用，就是下载pip。这让人怀疑，这个软件的开发时间，似乎比2012年之前吧。
恐怕是一笔代码债务……

虽然怀着一颗忐忑的心，我还是下下来试试看。
结果果然不出我所料，虽然它给我提出了一大堆编程风格上的问题，但是真要指出一些语法上的错误，一点都不中用。
唉，又是一个Google的弃宠。

下一个：jshint

jshint
-----

为了不显得罗嗦，我就写下最终的结局吧。
在故事的最后，jshint和syntastic幸福快乐地生活在一起。

在我看来，jshint是恰到好处，既不会太唠叨，也不会太粗笨。
于是乎，js的语法检查就托付给它了。
